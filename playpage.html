<!DOCTYPE html PUBLIC "-//WAPFORUM//DTD XHTML Mobile 1.0//EN" "http://www.wapforum.org/DTD/xhtml-mobile10.dtd">
<html lang="en">

<head>
  <meta name="viewport"
    content="width=device-width, height=device-height, initial-scale=1.0, maximum-scale=0.25 user-scalable=0" />
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>矮人礦坑</title>
  <!-- <link rel="shortcut icon" href="https://i.ibb.co/vJ42VtN/ia2b-001.png" type="image/x-icon" /> -->
  <meta name="1A2B" content="矮人礦坑" />
  <meta property="og:title" content="矮人礦坑" />
  <!-- <meta property="og:image" content="https://i.ibb.co/3RxtDV9/001.png" /> -->
  <meta property="og:description" content="矮人礦坑！" />
  <script src="https://kit.fontawesome.com/5223ebc999.js" crossorigin="anonymous"></script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"
    integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
</head>
<link rel="stylesheet" href="playpage.css" />

<body>
  <div class="container">
    <div class="cuetext topcue">
      輪到你出牌了！ 你是壞矮人！ 排堆剩餘提醒:
    </div>
    <div class="flexbox playerarea">
      <div class="box">
        <div class="score">5</div>
        <img class="userpic" src="svg/user.svg" alt="" />
        <div class="username name1">阿婷</div>
        <div class="flexbox statusbox">
          <div class="status" style="
                background-image: url(svg/status/status_ax.svg);
                background-size: cover;
              "></div>
          <div class="status" style="
                background-image: url(svg/status/status_car.svg);
                background-size: cover;
              "></div>
          <div class="status" style="
                background-image: url(svg/status/status_lamb.svg);
                background-size: cover;
              "></div>
        </div>
      </div>

      <div class="box">
        <div class="score">5</div>
        <img class="userpic" src="svg/user.svg" alt="" />
        <div class="username name1">阿婷</div>
        <div class="flexbox statusbox">
          <div class="status" style="
                background-image: url(svg/status/status_ax.svg);
                background-size: cover;
              "></div>
          <div class="status" style="
                background-image: url(svg/status/status_car.svg);
                background-size: cover;
              "></div>
          <div class="status" style="
                background-image: url(svg/status/status_lamb.svg);
                background-size: cover;
              "></div>
        </div>
      </div>

      <div class="box">
        <div class="score">5</div>
        <img class="userpic" src="svg/user.svg" alt="" />
        <div class="username name1">阿婷</div>
        <div class="flexbox statusbox">
          <div class="status" style="
                background-image: url(svg/status/status_ax.svg);
                background-size: cover;
              "></div>
          <div class="status" style="
                background-image: url(svg/status/status_car.svg);
                background-size: cover;
              "></div>
          <div class="status" style="
                background-image: url(svg/status/status_lamb.svg);
                background-size: cover;
              "></div>
        </div>
      </div>
    </div>
<!-- 棋盤格子區 -->
    <div class="flexbox showarea">
      <div class="line line1">
        <div id="block1-1" class="block block1-1">
          <img data-num="0" src="svg/cards_blank.svg" alt="" id="end1" />
        </div>
        <div id="block1-2" class="block block1-2"></div>
        <div id="block1-3" class="block block1-3">
          <img data-num="1" src="svg/cards_blank.svg" alt="" id="end2" />
        </div>
        <div id="block1-4" class="block block1-4"></div>
        <div id="block1-5" class="block block1-5">
          <img data-num="2" src="svg/cards_blank.svg" alt="" id="end3" />
        </div>
      </div>
      <div class="line line2">
        <div id="block2-1" class="block block2-1"></div>
        <div id="block2-2" class="block block2-2"></div>
        <div id="block2-3" class="block block2-3"></div>
        <div id="block2-4" class="block block2-4"></div>
        <div id="block2-5" class="block block2-5"></div>
      </div>
      <div class="line line3">
        <div id="block3-1" class="block block3-1"></div>
        <div id="block3-2" class="block block3-1"></div>
        <div id="block3-3" class="block block3-1"></div>
        <div id="block3-4" class="block block3-1"></div>
        <div id="block3-" class="block block3-1"></div>
      </div>
      <div class="line line4">
        <div id="block4-1" class="block block4-1"></div>
        <div id="block4-2" class="block block4-1"></div>
        <div id="block4-3" class="block block4-1"></div>
        <div id="block4-4" class="block block4-1"></div>
        <div id="block4-5" class="block block4-1"></div>
      </div>
      <div class="line line5">
        <div id="block5-1" class="block block5-1"></div>
        <div id="block5-2" class="block block5-1"></div>
        <div id="block5-3" class="block block5-1"></div>
        <div id="block5-4" class="block block5-1"></div>
        <div id="block5-5" class="block block5-1"></div>
      </div>
      <div class="line line6">
        <div id="block6-1" class="block block6-1"></div>
        <div id="block6-2" class="block block6-1"></div>
        <div id="block6-3" class="block block6-1"></div>
        <div id="block6-4" class="block block6-1"></div>
        <div id="block6-5" class="block block6-1"></div>
      </div>
      <div class="line line7">
        <div id="block7-1" class="block block7-1"></div>
        <div id="block7-2" class="block block7-1"></div>
        <div id="block7-3" class="block block7-1"></div>
        <div id="block7-4" class="block block7-1"></div>
        <div id="block7-5" class="block block7-1"></div>
      </div>
      <div class="line line8">
        <div id="block8-1" class="block block8-1"></div>
        <div id="block8-2" class="block block8-1"></div>
        <div id="block8-3" class="block block8-1"></div>
        <div id="block8-4" class="block block8-1"></div>
        <div id="block8-5" class="block block8-1"></div>
      </div>
      <div class="line line9">
        <div id="block9-1" class="block block9-1"></div>
        <div id="block9-2" class="block block9-1"></div>
        <div id="block9-3" class="block block9-1">
          <img src="svg/card_start.svg" alt="" />
        </div>
        <div id="block9-4" class="block block9-1"></div>
        <div id="block9-5" class="block block9-1"></div>
      </div>
    </div>

    <!-- 倒數計時器區域 -->
    <div class="round-time-bar" data-style="smooth" style="--duration: 60">
      <div></div>
    </div>
    <div>時間剩下<span id="time">01:00</span>秒！你給我趕快出牌喔＾＾</div>
    <!-- 提示區 -->
    <div class="cuetxt">
      請放置卡牌開闢新的路，或是
      <span class="trash"><i class="fas fa-trash fa-lg">棄牌並跳過</i></span>
    </div>

    <!-- 手牌區 -->
    <div class="flexbox handcardarea">
      <div class="handcardbox1" data-num="1">
        <div id="box1">
          <img class="card cardnum1" data-num="1" src="svg/cards/card_car_ban.svg" />
        </div>
        <i data-num="1" class="fas fa-undo-alt cycle-1"></i>
      </div>

      <div class="handcardbox2" data-num="2">
        <div id="box2">
          <img class="card cardnum2" data-num="2" src="svg/cards/card_car.svg" />
        </div>
        <i data-num="2" class="fas fa-undo-alt cycle-2"></i>
      </div>

      <div class="handcardbox3" data-num="3">
        <div id="box3">
          <img class="card cardnum3" data-num="3" src="svg/cards/card_road2.svg" />
        </div>
        <i data-num="3" class="fas fa-undo-alt cycle-3"></i>
      </div>

      <div class="handcardbox4" data-num="4">
        <div id="box4">
          <img class="card cardnum4" data-num="4" src="svg/cards/card_hole1.svg" />
        </div>
        <i data-num="4" class="fas fa-undo-alt cycle-4"></i>
      </div>

      <div class="handcardbox5" data-num="5">
        <div id="box5">
          <img class="card cardnum5" data-num="5" src="svg/cards/card_map.svg" />
        </div>
        <i data-num="5" class="fas fa-undo-alt cycle-5"></i>
      </div>

      <div class="handcardbox6" data-num="6">
        <div id="box6">
          <img class="card cardnum6" data-num="6" src="svg/cards/card_bomb.svg" />
        </div>
        <i data-num="6" class="fas fa-undo-alt cycle-6"></i>
      </div>
    </div>
  </div>
  <!-- //放在container外的，遊戲角色顯示 -->
  <!-- Button trigger modal -->
  <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#staticBackdrop">
    遊戲回合勝負結果
  </button>

  <!-- Modal -->
  <div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
    aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        <img src="svg/status/goodwin.svg" alt="" class="winpic">
        <div class="modal-header">
          <h5 class="modal-title" id="staticBackdropLabel">好矮人獲勝！</h5>
        </div>
        <div class="modal-body">
          獲勝玩家：
          <div class="username name1">阿婷 <span>5分</span></div>
          <div class="username name2">阿文 <span>5分</span></div>
        </div>
        <div class="modal-footer">
          <!-- <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button> -->
          <button type="button" class="homebtn">回首頁</button>
          <button type="button" class="palyagain">再玩一局</button>
          <button type="button" class="rankbtn">看總排行</button>

        </div>
      </div>
    </div>
  </div>
</body>

<script>
  // 倒數計時器
  function startTimer(duration, display) {
    var timer = duration,
      minutes, seconds;
    setInterval(function () {
      minutes = parseInt(timer / 60, 10);
      seconds = parseInt(timer % 60, 10);
      minutes = minutes < 10 ? "0" + minutes : minutes;
      seconds = seconds < 10 ? "0" + seconds : seconds;
      display.textContent = minutes + ":" + seconds;
      if (--timer < 0) {
        timer = duration;
      }
    }, 1000);
  }

  window.onload = function () {
    var fiveMinutes = 60 * 1,
      display = document.querySelector('#time');
    startTimer(fiveMinutes, display);
  };

  //倒數計時器顯示圖
  const bars = document.querySelectorAll(".round-time-bar");

  bars.forEach((bar) => {
    bar.classList.remove("round-time-bar");
    bar.offsetWidth;
    bar.classList.add("round-time-bar");
  });



  // 封鎖時顯示上方提示//
  $(".status").mouseenter(function () {
    $(this).addClass("statushover");
    $(".topcue").text("來啊！炸壞阿婷的油燈！");
  });
  $(".status").mouseleave(function () {
    $(this).removeClass("statushover");
    $(".topcue").text("輪到你出牌了！你是壞矮人～")
  });

  $(".status").click(function () {
    $(this).addClass("statusdelete");
    $(".topcue").text("阿婷的油燈被你炸～壞了！");
  });



  // 圖卡旋轉
  var degrees = 0;

  function rotatecard(object) {
    degrees += 180;
    console.log(degrees)
    object.css({
      'transform': 'rotate(' + degrees + 'deg)',
      '-ms-transform': 'rotate(' + degrees + 'deg)',
      '-moz-transform': 'rotate(' + degrees + 'deg)',
      '-webkit-transform': 'rotate(' + degrees + 'deg)',
      '-o-transform': 'rotate(' + degrees + 'deg)'
    });
  }

  var degrees = 0;
  $(".fa-undo-alt").on("click", function (e) {
    const number = $(this).attr("data-num")
    rotatecard($(".cardnum" + number));
  });




  //功能:點擊卡牌產生紅色提醒
  $(".card").click(function (e) {
    if ($(this).attr('class').search("redborder") == -1) {
      $(".redborder").removeClass("redborder");
      $(this).addClass("redborder");
    }
  });
  //功能:點擊區塊可放置卡牌、出牌後隨機再產生一張新卡牌到手排中
  $(".block").click(function (event) {
    if ($('.redborder').length == 0) {
      return;
    }
    const element = document.getElementById(event.target.id);
    const boxnum = $(".redborder").attr("data-num")
    const svg = $("#box" + boxnum).html();
    // const num = $(".fa-undo-alt").attr("data-num")
    element.innerHTML += `${svg}`;
    $(".redborder").removeClass("redborder");
    $("#box" + boxnum).hide();
    $(".cycle-" + boxnum).hide();

//功能隨機產生新手牌
    const randomcards = ['<img class="card cardnum${boxnum}" data-num="${boxnum}" src="svg/cards/card_car.svg"/>',
      '<img  style="width:63px;" src="svg/cards/card_road2.svg">',
      '<img  style="width:63px;" src="svg/cards/card_road3.svg">'
    ];


    const random = Math.floor(Math.random() * randomcards.length);
    let show = randomcards[random];
    $(".handcardbox" + boxnum).append(show);
    $(".handcardbox" + boxnum).append(`<i data-num=${boxnum} class="fas fa-undo-alt cycle-${boxnum}"></i>`);
  });


  // 功能：棄牌並跳過
  $(".trash").click(function (event) {
    if ($('.redborder').length == 0) {
      return;
    };
    const element = document.getElementById(event.target.id);
    const boxnum = $(".redborder").attr("data-num")
    $(".redborder").removeClass("redborder");
    $("#box" + boxnum).hide();
    $(".cycle-" + boxnum).hide();
    const randomcards = ['<img style="width:50px;" src="https://i.ibb.co/Tgy37Jd/icon1-3-3x.png">',
      '<img  style="width:50px;" src="https://i.ibb.co/nnK9ty3/icon1-4-3x.png">',
      '<img  style="width:50px;" src="https://i.ibb.co/rd8NqRF/icon1-2-3x.png">'
    ];
    const random = Math.floor(Math.random() * randomcards.length);
    let show = randomcards[random];
    $(".handcardbox" + boxnum).append(show);
    const newcue = document.querySelector(".cuetxt");
    newcue.innerHTML = `<div class="cuetxt">剛剛你吃掉了一張手牌，好胖</div>`;
    // <div class="cuetxt">請放置卡牌開闢新的路，或是 <span class="trash"><i class="fas fa-trash fa-lg">棄牌並跳過</i></span></div>

  })


  //隨機產生三張終點卡//
  let endCards = [];

  let endCardsGenerator = function (arr) {
    if (arr.length >= 3) return;
    let newNumber = Math.floor(Math.random() * 3 + 1);
    if (arr.indexOf(newNumber) < 0) {
      arr.push(newNumber);
    }
    endCardsGenerator(arr);
  };
  endCardsGenerator(endCards);

  // console.log(endCards[0]);
  // console.log(endCards[1]);
  // console.log(endCards[2]);

  $("#end1").click(function () {
    $(this).attr("src", `svg/card_end${endCards[0]}.svg`);
    rotatecard($(this));
  });

  $("#end2").click(function () {
    $(this).attr("src", `svg/card_end${endCards[1]}.svg`);
    rotatecard($(this));
  });
  $("#end3").click(function () {
    $(this).attr("src", `svg/card_end${endCards[2]}.svg`);
    rotatecard($(this));
  });

  //點選連結到別的畫面

  $('.homebtn').click(function () {
    window.location.href = "./index.html";
  })
  $('.palyagain').click(function () {
    window.location.href = "./waiting.html";
  })
  $('.rankbtn').click(function () {
    window.location.href = "./rank.html";
  })
</script>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/css/bootstrap.min.css" rel="stylesheet" //
  integrity="sha384-wEmeIV1mKuiNpC+IOBjI7aAzPcEZeedi5yW5f2yOq55WWLwNGmvvx4Um1vskeMj0" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"
  integrity="sha384-p34f1UUtsS3wqzfto5wAAmdvj+osOnFyQFpp4Ua3gs/ZVWx6oOypYoCJhGGScy+8" crossorigin="anonymous">
</script>

</html>