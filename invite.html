<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>矮人礦坑</title>
    <link rel="shortcut icon" href="svg/icon.svg" type="image/x-icon" />
    <meta name="1A2B" content="矮人礦坑">
    <meta property="og:title" content="矮人礦坑" />
    <meta property="og:image" content="svg/icon.svg" />
    <meta property="og:description" content="矮人礦坑！" />

    <script src="https://kit.fontawesome.com/5223ebc999.js" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"
        integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous">
    </script>
</head>
<link rel="stylesheet" href="invite.css">

<body>
    <div class="container">
        <img src="svg/logo.svg" alt="logo pic" class="logo">
        <img src="svg/welcome.svg" alt="" class="welcome pic">


        <div class="text"></div>
        <h4>你被邀請加入房間</h4>

        <input id="nickname" placeholder="請輸入玩家暱稱..." />

        <input type="button" class="start" value="開始遊戲">

    </div>


</body>

<script src="./script/api.js"></script>
<script src="./script/common.js"></script>
<script>
    var currentRoomId = getUrlParameter('room_id');
    //nickName
    $(document).ready(function () {
        const nickname = getNickName();
        $('#nickname').val(nickname);
    });

    $('.start').click(function () {
        const nickname = $('#nickname').val();
        if (nickname.trim() === '') {
            alert('請輸入暱稱');
            return;
        }
        saveNickName(nickname);

        callApi(`/rooms/${currentRoomId}/players`, 'POST', { name: nickname }).then((response) => {
            window.location.href = `./waiting.html?room_id=${currentRoomId}&invite=1`;
        });

    });
    const getNickName = () => {
        const nickname = window.localStorage.getItem('nickname');
        return nickname ? nickname : '';
    }

    const saveNickName = (nickname) => {
        window.localStorage.setItem("nickname", nickname)
    }

    const getApi = () => {
        return 'https://game.dev.newideas.com.tw/';
    }
</script>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/css/bootstrap.min.css" rel="stylesheet" //
    integrity="sha384-wEmeIV1mKuiNpC+IOBjI7aAzPcEZeedi5yW5f2yOq55WWLwNGmvvx4Um1vskeMj0" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-p34f1UUtsS3wqzfto5wAAmdvj+osOnFyQFpp4Ua3gs/ZVWx6oOypYoCJhGGScy+8" crossorigin="anonymous">
</script>


</html>